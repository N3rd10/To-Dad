<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Father's Day</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Inter', sans-serif;
      background: #121212;
      color: #eee;
      overflow: hidden;
    }
    #container {
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      user-select: none;
      touch-action: none;
    }
    canvas {
      display: block;
      max-width: 100%;
      height: 100vh;
      outline: none;
      cursor: grab;
    }
    canvas:active {
      cursor: grabbing;
    }
    h1 {
      position: absolute;
      top: 24px;
      left: 24px;
      font-weight: 600;
      font-size: 1.5rem;
      background: rgba(27, 27, 27, 0.7);
      padding: 8px 16px;
      border-radius: 12px;
      user-select: none;
      z-index: 10;
    }
    #loading {
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(27, 27, 27, 0.7);
      padding: 6px 16px;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 500;
      pointer-events: none;
      user-select: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="container" aria-label="3D model viewer with confetti">
    <div id="loading" aria-live="polite" aria-atomic="true" hidden>Loading model...</div>
  </div>

  <!-- Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/examples/js/controls/OrbitControls.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/examples/js/loaders/GLTFLoader.min.js"></script>
  <script>
    const container = document.getElementById('container');
    const loadingIndicator = document.getElementById('loading');
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0x121212);
    renderer.outputEncoding = THREE.sRGBEncoding;
    container.appendChild(renderer.domElement);

    const scene = new THREE.Scene();

    // Camera positioned high above looking down (top view).
    const camera = new THREE.PerspectiveCamera(
      45,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );
    camera.position.set(0, 10, 0.01); // Slight offset in Z to avoid singularity looking straight down
    camera.lookAt(0, 0, 0);

    // OrbitControls with target at origin (model center)
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.target.set(0, 0, 0);
    controls.enableDamping = true;
    controls.dampingFactor = 0.1;
    controls.minDistance = 1;
    controls.maxDistance = 50;
    controls.screenSpacePanning = false;

    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(ambientLight);
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(5, 10, 7);
    scene.add(directionalLight);

    // Placeholder cube
    const placeholderGeometry = new THREE.BoxGeometry(1, 1, 1);
    const placeholderMaterial = new THREE.MeshStandardMaterial({
      color: 0x8b5cf6,
      roughness: 0.5,
      metalness: 0.7,
    });
    const placeholderCube = new THREE.Mesh(placeholderGeometry, placeholderMaterial);
    scene.add(placeholderCube);

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }, false);

    // Confetti setup
    const confettiCount = 150;
    const confettiGeometry = new THREE.PlaneGeometry(0.1, 0.2);
    const confettiMaterial = new THREE.MeshStandardMaterial({
      color: 0xffffff,
      side: THREE.DoubleSide,
      roughness: 0.6,
      metalness: 0.2,
    });
    const confettiParticles = [];
    const confettiColors = [
      0xff3366, 0x33ff99, 0x6699ff, 0xffcc33,
      0xff66cc, 0x33ccff, 0x99ff66, 0xff9933
    ];
    for (let i = 0; i < confettiCount; i++) {
      const material = confettiMaterial.clone();
      material.color.setHex(confettiColors[i % confettiColors.length]);
      const particle = new THREE.Mesh(confettiGeometry, material);
      particle.position.set(
        (Math.random() - 0.5) * 6,
        Math.random() * 3 + 1.5,
        (Math.random() - 0.5) * 6
      );
      particle.rotation.set(
        Math.random() * Math.PI,
        Math.random() * Math.PI,
        Math.random() * Math.PI
      );
      particle.userData = {
        velocity: new THREE.Vector3(
          (Math.random() - 0.5) * 0.01,
          -0.02 - Math.random() * 0.015,
          (Math.random() - 0.5) * 0.01
        ),
        rotationSpeed: new THREE.Vector3(
          (Math.random() - 0.5) * 0.06,
          (Math.random() - 0.5) * 0.06,
          (Math.random() - 0.5) * 0.06,
        )
      };
      confettiParticles.push(particle);
      scene.add(particle);
    }

    function loadModel(url) {
      loadingIndicator.hidden = false;
      loadingIndicator.textContent = 'Loading model...';

      const loader = new THREE.GLTFLoader();
      loader.load(
        url,
        (gltf) => {
          scene.remove(placeholderCube);
          scene.add(gltf.scene);
          loadingIndicator.hidden = true;
        },
        (xhr) => {
          if (xhr.lengthComputable) {
            const percentComplete = Math.round((xhr.loaded / xhr.total) * 100);
            loadingIndicator.textContent = `Loading model... ${percentComplete}%`;
          }
        },
        (error) => {
          loadingIndicator.textContent = 'Failed to load model.';
          console.error('Error loading model:', error);
        }
      );
    }
    // Uncomment and update the path to your Blender exported .glb file:
    // loadModel('fathers day.glb');

    function animate() {
      requestAnimationFrame(animate);

      placeholderCube.rotation.x += 0.007;
      placeholderCube.rotation.y += 0.013;

      confettiParticles.forEach(p => {
        p.position.add(p.userData.velocity);
        p.rotation.x += p.userData.rotationSpeed.x;
        p.rotation.y += p.userData.rotationSpeed.y;
        p.rotation.z += p.userData.rotationSpeed.z;

        if (p.position.y < -1) {
          p.position.set(
            (Math.random() - 0.5) * 6,
            4 + Math.random() * 2,
            (Math.random() - 0.5) * 6
          );
          p.userData.velocity.set(
            (Math.random() - 0.5) * 0.01,
            -0.02 - Math.random() * 0.015,
            (Math.random() - 0.5) * 0.01
          );
        }
      });

      controls.update();
      renderer.render(scene, camera);
    }
    animate();

  </script>
</body>
</html>

